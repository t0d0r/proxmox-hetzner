# network interface settings; autogenerated
# Please do NOT modify this file directly, unless you know what
# you're doing.
#
# If you want to manage parts of the network configuration manually,
# please utilize the 'source' or 'source-directory' directives to do
# so.
# PVE will preserve these directives, but will NOT read its network
# configuration from sourced files, so do not attempt to move any of
# the PVE managed interfaces into external files!

source /etc/network/interfaces.d/*

auto lo
iface lo inet loopback

iface lo inet6 loopback

#iface {{INTERFACE_NAME}} inet manual
iface enp193s0f0np0 inet manual

auto vmbr0
iface vmbr0 inet static
    address {{MAIN_IPV4_CIDR}}
    gateway {{MAIN_IPV4_GW}}
#    bridge-ports {{INTERFACE_NAME}}
    bridge-ports enp193s0f0np0
    bridge-stp off
    bridge-fd 1
    bridge-vlan-aware yes
    bridge-vids 2-4094
    hwaddress {{MAC_ADDRESS}}
    pointopoint {{MAIN_IPV4_GW}}
    up sysctl -p

iface vmbr0 inet6 static
    address {{IPV6_CIDR}}
    gateway fe80::1

auto vmbr1
iface vmbr1 inet static
    address {{PRIVATE_IP_CIDR}}
    bridge-ports none
    bridge-stp off
    bridge-fd 0
    post-up   iptables -t nat -A POSTROUTING -s '{{PRIVATE_SUBNET}}' -o vmbr0 -j MASQUERADE
    post-down iptables -t nat -D POSTROUTING -s '{{PRIVATE_SUBNET}}' -o vmbr0 -j MASQUERADE
    post-up   iptables -t raw -I PREROUTING -i fwbr+ -j CT --zone 1
    post-down iptables -t raw -D PREROUTING -i fwbr+ -j CT --zone 1


iface vmbr1 inet6 static
	address {{FIRST_IPV6_CIDR}}

